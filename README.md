
Note: this code is adapted from private repo where it was based on private API, so
architecture of this API might not be optimal.

Tested with python 3.10, pytorch 2.0